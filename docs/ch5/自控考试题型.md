# 自动控制系统的频率分析

## 1、频率响应

- 关键点是正弦输入

## 2、幅相频率特性

### 基本环节幅相频率特性曲线

按照下面的方式都能绘制出来，其中比较关键的点是二阶不稳定振荡环节的初始相位需要注意初始是-360 度

初始相位的确定方式是可以根据终止的相位进行逆推，便可知道起始相位是多少，终止相位很容易就确定

阶数为 m/n 的传递函数，终止相位为 90°\*(m-n)

- 下面是典型环节的幅相频率特性曲线汇总：

  ![1651459041362](自控考试题型.assets/1651459041362.png)

### 绘制一般传递函数的幅相频率特性曲线

- 理解思路：问题的关键就是 w 从 0-->无穷，各矢量是怎么变化的，如何进行叠加得到最终的结果，如果是单调的话很好很方便的从起始点和终点再根据中间矢量的单调变化进行绘制图像；如果不是单调的话，幅值和相位是一种复合的关系，图像会出现螺旋的形状，有交叉。

1. 在 s 平面中将零点和极点找出

2. 在 G(jw)平面以矢量形式理解（把各个零点极点和原点相连得到矢量，作差即可得到每个因式的矢量结果，最后进行矢量叠加即可）

3. 确定好起点和终点，中间单调的话大致可以画出来；如果不是单调的话需要使用数值求解画图

4. 对于矢量的叠加，幅值相乘，相角相加

5. 按照以上步骤除了使用数值画法，只能画出很粗略的曲线，很多关键交点都没有确定，如果需要确定关键的点的坐标，需要将传递函数写成 X+jY 的形式，分别根据虚部为 0 和实部为 0 确定一些关键的交点。（解方程）

   同时也可以求出渐近线，比如虚部趋于无穷-》解出对应的 w，代入实部解得实部值即为渐近线。

## 3、对数频率特性（Bode 图）

###1、对数坐标特点

横轴按 llgw 刻度，但标是按照 w 标值（等距等比，等比的 q 就是倍频数）。w 差十倍称为 10 倍频，每个十倍频之间是等间隔的。注意 w 没有了 0 这个点，也相当于把低频段拉长，高频段压缩

纵轴按 20lg|G(jw)|刻度和标值的。

==所以在看对数坐标图时把 lgw 看成一个整体作为横坐标的自变量==

---

早期描述声音的大小：由于声音的响度和其功率不是成线性关系

![1651460092372](自控考试题型.assets/1651460092372.png)

20lg 是怎么来的：

![1651459849333](自控考试题型.assets/1651459849333.png)

电学中使用输出功率与输入功率的比值定义传递函数，而功率是 U^2^/R，一比就为 U^2^之比，提到前面就是 20lg

---

**特点**：

(1)幅值相乘=对数相加，便于叠加作图：
(2)可在大范围内表示频率特性：
(3)利用实验数据容易确定 L(w).进而确定 G(s),从对数特性确定传递函数

### 2、典型环节的对数频率特性：

蓝色的表达式为不稳定环节。

![1651460853591](自控考试题型.assets/1651460853591.png)

---

惯性环节的对数相频特性曲线关于点（w=1/T，φ=-45°）这个点对称

证明：φ（1/TK）+φ（K/T）=-90°

![1651461367395](自控考试题型.assets/1651461367395.png)

$$
\tan ( \alpha + \beta ) = \frac { \tan \alpha + \tan \beta } { 1 - \tan \alpha \cdot \tan \beta } = \frac { -\frac { 1 } { K } - K } { 1 - \frac { 1 } { K } *k } = - \infty
$$

---

![1651461641746](自控考试题型.assets/1651461641746.png)

转折点在最不准的地方，此时实际 L(1) = 3dB,但在工程上近似成 0

找转折点的方法，当 w 趋于无穷时，L(w)的表达式写出来，令其与当 L(w)w->0 时的值，求出 w 即为转折点。

##### ==转折点链接==

![1651462467372](自控考试题型.assets/1651462467372.png)

振荡环节的两种表达形式的联系

使用幅相频率特性图时，阻尼比 ξ 越小（β*为极点或零点与实负半轴的夹角* 越大），曲线开始就越往外扩(可以使用极限思想，当无阻尼的情况两个极点在虚轴上)，存在一个谐振峰值，在 w~r~处取得最大值，如果是 ξ = 0,w~r~=w~n~取得极大值

$$
w _ { r } = w _ { n } \sqrt { 1 - 2 ξ^ { 2 } } , M _ { r} = \frac { 1 } { 2 ξ \sqrt { 1 - ξ ^ { 2 } } }
$$

相应的在对数坐标图中取得极大值在上凸的最高点，也是在 w = w~r~处取得，阻尼比越小，凸的越厉害

![1651463512372](自控考试题型.assets/1651463512372.png)

确定对数频率曲线起始和终止和斜率都是通过极值法，转折点的确定同[上面所述](#==转折点链接==)

![1651466209299](自控考试题型.assets/1651466209299.png)

乘以-57.3° 是因为相角是以弧度表示的。

---

已知对数频率特性曲线求出传递函数并与 Nyquist 图对应：

例题：

1. 惯性

![1651475723834](自控考试题型.assets/1651475723834.png)

==注意点：对数坐标是以 lgw 刻度的，所以在使用斜率的时候是以 lgw 为整体看做横坐标==

2. 二阶

![1651476051634](自控考试题型.assets/1651476051634.png)

![1651476590769](自控考试题型.assets/1651476590769.png)

==注意点：谐振频率和谐振峰值的计算、阻尼系数 ξ<0.707 时没有谐振峰值，因为 Nyquist 曲线一直是向内收缩的。所以 ξ 取 0.203，求得 w~n~=30 后借助近似的波特图中的斜率（即转折点 ）求出 w~c~==

---

## 3、 典型环节 Bode 图和 Nyquist 图对应关系

![1651476978641](自控考试题型.assets/1651476978641.png)

## 4、系统的开环 Bode 图

原本的 Nyquist 图直接绘制|G(jw)|各环节是乘积，不好判断和绘制

Bode 图取完对数变乘为叠加，可以很方便的绘制出来

![1651477260967](自控考试题型.assets/1651477260967.png)

绘制步骤总结：\*\*

1. 对数幅频曲线画法：

![1651477677499](自控考试题型.assets/1651477677499.png)

注意点：首先得化成尾 1 标准型，可以知道开环增益，基准点是由开环增益求出，并由积分环节的阶数确定斜率进而==确定基准线==，先不考虑其他环节的，作出基准线后再考虑其他环节，考虑方法如上图(4)，在绘制转折线时的斜率需要在图上取平行线。列出转折频率中，一阶的化为尾一标准型后，转折频率即每一各因式中的分母上的字，二阶的转折频率为 w~n~（下图附上转折频率找法）

![1651480961415](自控考试题型.assets/1651480961415.png)

绘制例题：

![1651478327563](自控考试题型.assets/1651478327563.png)

修正：因为两个惯性环节转折频率接近时转折点的误差比较大，≈20lg2，二阶的阻尼系数 ξ 太小（转折点处抬得太高）或 太大（转折点处压得太低） 时需要适当进行修正（方法是查表）

**绘制步骤小结：**

![1651478543396](自控考试题型.assets/1651478543396.png)

2. 对数相频曲线画法：

   起始点的相位，遇到转折处或者是转折处的 10 倍频处考虑一阶 ±45° 或者是二阶 ±90°，也可以使用更加精确的画法，每一个环节都单独画出来，在起始相位确定后，每个转折频率把所有环节进行叠加。

## 5、复杂系统开环传递函数的例子

![1651481942604](自控考试题型.assets/1651481942604.png)

关键点是原本考虑是在虚轴正一点开始考虑，现在还得从实轴上绕个无限小的 1/4 圆，在图上对应的幅相频率特性曲线为虚线那一段。

## 6、频域稳定判据

频域稳定判据：Nyquist 判据和对数稳定判据

![1651667415482](自控考试题型.assets/1651667415482.png)

### 1、Nyquist 稳定判据

Z = P - 2N（Z 为闭环 s 右半平面内极点个数，P 为闭环极点在右半平面个数，N 为幅相频率特性曲线饶-1 转过的圈数）

例子：![1651667893846](自控考试题型.assets/1651667893846.png)

要求 F（s）在右半平面的零点和极点的个数差，但是零点没求，就是为了绕过这个求零点的坎，求 F（s）绕原点转过的角度，但是|F（jw）|不好画，转而画 Gk(s)绕-1 转过的角度。（逆时针为+，顺时针为负）再根据 Z = P-2N

求出 Z。2N 的原因是原本是 Z = P - R，R 是 F(s)绕原点转过的圈数，s 走的是一个半圆（注意当有极点为 0 时，s 走的路径需要从从有极限绕过去，不是直接穿过 0），现在在 Gk(s)中走的是 s 从 0-》无穷。根据对称得出 R = 2N。

![1651723907765](自控考试题型.assets/1651723907765.png)

![1651676741513](自控考试题型.assets/1651676833560.png)

例子：

![1651671834357](自控考试题型.assets/1651671834357.png)

![1651672019456](自控考试题型.assets/1651672019456.png)

![1651672437298](自控考试题型.assets/1651672437298.png)

### 2、对数稳定判据

在以原点为圆心，以 1 为半径画穿过-1 的单位圆，单位圆之外，幅相频率特性曲线穿过-180° 的次数决定了绕多少圈，所以等价与在对数坐标中，对数幅值频率特性曲线在大于 0 的时候，相位频率特性曲线穿过-180° 的次数。正穿越（负得更小了）数-负穿越（负得更大了）数为 N 的取值。

==在对数幅值大于 0 的时候，相位曲线贴着-180° 向上为 N~+~=1/2，相位曲线贴着-180° 向下，N~-~=1/2==

==本质应该是穿越（2N+1）\*-180° 都是算穿越==

例题：

![1651675609805](自控考试题型.assets/1651675609805.png)

==关键关键：不稳定环节需要逆推初始相位==

![1651676692708](自控考试题型.assets/1651676692708.png)

![1651725918259](自控考试题型.assets/1651725918259.png)

关键点：振荡环节，无阻尼，理论上凸起无穷高，所以始终有一次负穿越。还有就是 s 从 0 到无穷时，需要从虚轴上的极点右边绕过去。

![1651727383072](自控考试题型.assets/1651727383072.png)

==本质应该是穿越（2N+1）\*-180° 都是算穿越==

所以即使整个对数相频曲线都在-180° 上方也存在穿越

---

## 7、稳定裕度

截止频率 w~c~：幅值等于 1，对数幅频曲线等于 0 处的频率

相角裕度 γ = 180° +∠G(jw~c~)

幅值裕度 h = 1/|G(jw~g~)| ,w~g~为幅相频率特性曲线与-180° 的交点处对应的频率

以上两个概念是为了粗略描述曲线与（-1，j0）之间的距离，可以这样理解，恰好穿过时是临界稳定，那么稍微一变就可能不稳定了（因为之前没包，突然就变包围了，或者之前包围，突然变不包围 Z=P-2N），所以距离一定距离理解为稳定的储备量（所以这个裕度就是目前处于稳定，还有多少相角度数可以消耗）

1. γ 是系统在相角方面稳定储备量
2. h 是系统在幅值方面的稳定储备量

注意稳定裕度只有在系统是稳定时才有这个概念，那么 γ 可以确定一定为一个正值，或者说减去 2N\*180° 会是一个正值

计算方法：

例题：

- 相角裕度：

  ![1651914413204](自控考试题型.assets/1651914413204.png)

  ​

- 幅值裕度：

  方法一：

  ![1651914335969](自控考试题型.assets/1651914335969.png)

  方法二：

  ![1651914289990](自控考试题型.assets/1651914289990.png)

---

波特图中解相角裕度

![1651915162939](自控考试题型.assets/1651915162939.png)

![1651915887885](自控考试题型.assets/1651915887885.png)

本题由于是一个积分环节和两个惯性环节，由于同阶在对应位置移动相同的频率值变化的相角相同（对应位置理解为比如同在比起始相位降低 45° 的地方为对应位置），所以 w~g~在两个转折频率的中点处，即

lg（w~g~）=0.5*lg（w1*w2）

---

波特图上找 w~c~注意 1：2：sqrt(5) ,可以借助等距即对数中的真数为同一比值这一特点，如下面这一题

![1651917595129](自控考试题型.assets/1651917595129.png)

![1651917846635](自控考试题型.assets/1651917846635.png)

---

![1651918418772](自控考试题型.assets/1651918418772.png)

w~g~的计算方法还有把开环写成虚部实部的样子，令虚部等于 0，求出 w~g~后代入实部再取个倒数即可算出 幅值裕度

##8、动态性能指标

### 1、三频段理论

![1651923759032](自控考试题型.assets/1651923759032.png)

高频段开环增益很小，等价于闭环增益也很小

### 最小相位系统

- 根据对数幅频曲线就可以大致想出对数相频曲线（根据的是斜率和转折点，在转折点变化一半，十倍频处变化全部）
- 就是看谁为主导，在本环节中它的目标是到哪个相位，按照这个思想可以很快的大致画出对数相频曲线。

### 动态性能指标分析

- 二阶系统：相角裕度和超调量都只与阻尼比有关，所以已知一个可通过查图求另一个

  w~c~是通过开环幅相频率曲线模为 1 解方程求出来的

![1651929192214](自控考试题型.assets/1651929192214.png)

t~s~w~c~=7/tanγ 只要查出根据相角裕度 γ 查出 t~s~w~c~即可根据 w~c~求出 t~s~

例题：

![1651929437501](自控考试题型.assets/1651929437501.png)

- 高阶系统频域法估计系统性能指标

  同样是求出相角裕度 γ 和截止频率

  ![1651929655683](自控考试题型.assets/1651929655683.png)

  ![1651932237372](自控考试题型.assets/1651932237372.png)

- 最小相位系统只要相角或者幅值裕度大于 0 即可判断为稳定

- ![1651932622197](自控考试题型.assets/1651932622197.png)

- 三频段理论：![1651933002843](自控考试题型.assets/1651933002843.png)

  ![1651933311854](自控考试题型.assets/1651933311854.png)

## 9、闭环频率特性曲线绘制

- 等 M 圆，利用开环系统的模表示出闭环系统的模，求出一系列等 M 的轨迹，与开环系统曲线交点即可得知对应点闭环曲线的模

  ![1651995173027](自控考试题型.assets/1651995173027.png)

  ​

- 等 N 圆，利用闭环相角表示出来并以把某一相角当做常数，画出圆

  ![1651995128392](自控考试题型.assets/1651995128392.png)

- 闭环特性曲线几个特征量：

  ![1651995590030](自控考试题型.assets/1651995841168.png)

  带宽频率 w~b~的概念是在闭环特性曲线上，幅值变为原来的 0.707 倍时的频率。

- 闭环频域与时域指标的关系：

  阻尼比 ξ，阻尼角 β，稳定裕度 γ，超调量 σ％，谐振频率 w~r~，谐振峰值 M~r~

- 求二阶闭环系统的谐振峰值和带宽频率都其他都可以求出，如下面的例题（但其实用时域法还是更快一点，套公式）

  ![1651997341683](自控考试题型.assets/1651997341683.png)

  ![1651997726547](自控考试题型.assets/1651997726547.png)

- 高阶系统性能指标：

  ![1651997833491](自控考试题型.assets/1651997833491.png)

- 频域法分析系统动态性能指标总结：

![1651999363500](自控考试题型.assets/1651999363500.png)

## 10、频率法校正

### 1、串联超前校正

![1652008006433](自控考试题型.assets/1652008006433.png)

![1652009084900](自控考试题型.assets/1652009084900.png)

![1652009296383](自控考试题型.assets/1652009296383.png)

加 5°\~10° 是为了弥补之前传递函数由于截止频率 w~c~后移导致的相位减小。

如果是求出了 10lga 后画出图后发现 w~c~还不满足要求，就以指标中的 w~c~作为设计标准，而不是计算出来的 φ~m~去计算得到的 10lga 作为目标去设计，这样因为截止频率处的相位也肯定带得起来，因为给了更长的频率空间去往上拔高相位了。

---

**例题 1：**

![1652021041240](自控考试题型.assets/1652021041240.png)

![1652021066023](自控考试题型.assets/1652021066023.png)

![1652021084171](自控考试题型.assets/1652021084171.png)

![1652021110855](自控考试题型.assets/1652021110855.png)

![1652023597593](自控考试题型.assets/1652023597593.png)

![1652023716204](自控考试题型.assets/1652023716204.png)

![1652023804444](自控考试题型.assets/1652023804444.png)

![1652023911886](自控考试题型.assets/1652023911886.png)

![1652023987565](自控考试题型.assets/1652023987565.png)

![1652024054001](自控考试题型.assets/1652024054001.png)

验算的时候发现相角裕度的弥补取 5° 太小了，可以采取将校正的较大的转折频率往后移动，使在截止频率处的校正相角变大（大概取一下，后面还需要验证），拉上去一点。

![1652025971020](自控考试题型.assets/1652025971020.png)

![1652026038308](自控考试题型.assets/1652026038308.png)

如果要求 w~c~>=7,那么在算出 w~c~时可以在图中看出不满足要求，应该以 w~c~=7 为校正目标，以 w~c~=7 对应的分贝数为校正环节的 10lga 的那个值

![1652026486566](自控考试题型.assets/1652026486566.png)

**例题 2：**主要是进行时域指标和频域指标的转换，查表

![1652026769894](自控考试题型.assets/1652026769894.png)

看是否稳定还可以根据波特图上看 w~c~和 w~g~的前后关系，w~c~在前说明没有包围（-1,0j），说明是稳定的。因为开环极点也都在负平面

![1652027203095](自控考试题型.assets/1652027203095.png)

![1652027182197](自控考试题型.assets/1652027182197.png)

![1652027230054](自控考试题型.assets/1652027230054.png)

==这里采取加 10° 的原因是，后面有-60dB 十倍频的，w~c~后移时候，原本系统掉的相位较多，需要弥补多一些。==

![1652027343277](自控考试题型.assets/1652027343277.png)

使用斜率或者等距等比的关系，将所有的相关频率 w 算出

![1652027467174](自控考试题型.assets/1652027467174.png)

![1652027529194](自控考试题型.assets/1652027529194.png)

![1652027550648](自控考试题型.assets/1652027550648.png)

![1652027581536](自控考试题型.assets/1652027581536.png)

![1652027661380](自控考试题型.assets/1652027661380.png)

![1652027728216](自控考试题型.assets/1652027728216.png)

==算 w~g~的快速算法是当满足一个积分两个惯性时，中间段的重点处即为 w~g~因为那个点相位刚好是-180°==

![1652027867988](自控考试题型.assets/1652027867988.png)

![1652027920601](自控考试题型.assets/1652027920601.png)

---

![1652028422563](自控考试题型.assets/1652028422563.png)

###2、串联滞后校正

当要求的相角裕度和网络当前的相角裕度比较差的比较多时，单纯的使用超前网络已经无法将相位拉起来，需要使用滞后网络，使用滞后网络就是为了在本身系统的相位曲线上找到满足相位要求的 w~c~，并利用滞后网络衰减幅值的特点将 w~c~提前，此时系统本身拥有更高的相角裕度，也就是挖掘了系统本身的相角裕度，把截止频率 w~c~提前了

**这种校正方法用在 w~c~有余而相角裕度远远不足，因为一级超前校正最多拉起来 60°，算极值可知**

![1652079960021](自控考试题型.assets/1652079960021.png)

![1652080389039](自控考试题型.assets/1652080389039.png)

==考虑由于滞后网络加入的影响在需要修正的幅值处产生的滞后相位值，始终都是不大于-6°，所以在设计时可以多出 6° 的相位进行弥补。==

使用点是在第二个转折频率后十倍频处。因为那里的相位滞后足够小，且幅值满足为衰减的要求。

![1652080964081](自控考试题型.assets/1652080964081.png)

==当要求的相角裕度和网络当前的相角裕度比较差的比较多时，单纯的使用超前网络已经无法将相位拉起来，需要使用滞后网络，使用滞后网络就是为了在本身系统的相位曲线上找到满足相位要求的 w~c~，并利用滞后网络衰减幅值的特点将 w~c~提前，此时拥有更高的相角裕度。==

![1652081487337](自控考试题型.assets/1652081487337.png)

此系统为一个积分环节加上两个惯性环节，一看可以看出 w~g~小于 w~c~，也就是将（-1，j0）包围起来了，而且右半平面的开环极点个数 P=0，所以不稳定。

![1652082142043](自控考试题型.assets/1652082142043.png)

==计算 w~c0~时需要近似，不是把 1 丢了就是把 s 的部分丢了==

![1652083165259](自控考试题型.assets/1652083165259.png)

==关键点是在计算本身系统能满足相位裕度时的 w~c~（注意加上之后网络的滞后相位）==

![1652083212536](自控考试题型.assets/1652083212536.png)

![1652083259145](自控考试题型.assets/1652083259145.png)

![1652083308835](自控考试题型.assets/1652083308835.png)

![1652083544943](自控考试题型.assets/1652083544943.png)

![1652083563727](自控考试题型.assets/1652083563727.png)

![1652087436306](自控考试题型.assets/1652087436306.png)

### 3、串联滞后一超前校正

### 4、串联 PID 校正
